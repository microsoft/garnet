<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cluster/overview" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Overview | Garnet</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://microsoft.github.io/garnet/docs/cluster/overview"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Overview | Garnet"><meta data-rh="true" name="description" content="Garnet cluster provides an easy and scalable way to operate Garnet across multiple nodes."><meta data-rh="true" property="og:description" content="Garnet cluster provides an easy and scalable way to operate Garnet across multiple nodes."><link data-rh="true" rel="icon" href="/garnet/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://microsoft.github.io/garnet/docs/cluster/overview"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/garnet/docs/cluster/overview" hreflang="en"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/garnet/docs/cluster/overview" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Overview","item":"https://microsoft.github.io/garnet/docs/cluster/overview"}]}</script><link rel="alternate" type="application/rss+xml" href="/garnet/blog/rss.xml" title="Garnet RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/garnet/blog/atom.xml" title="Garnet Atom Feed">




<script>!function(t,e,n,c,a,r,s){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(r=e.createElement(c)).async=1,r.src="https://www.clarity.ms/tag/loh6v65ww5",(s=e.getElementsByTagName(c)[0]).parentNode.insertBefore(r,s)}(window,document,"clarity","script")</script><link rel="stylesheet" href="/garnet/assets/css/styles.a0a59612.css">
<script src="/garnet/assets/js/runtime~main.ec929e65.js" defer="defer"></script>
<script src="/garnet/assets/js/main.e77c437c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/garnet/img/garnet-logo-diamond.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/garnet/"><div class="navbar__logo"><img src="/garnet/img/garnet-logo-diamond.png" alt="Garnet Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/garnet/img/garnet-logo-diamond.png" alt="Garnet Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Garnet</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/garnet/docs">Docs</a><a class="navbar__item navbar__link" href="/garnet/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/microsoft/garnet" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/garnet/docs"><span title="Welcome" class="categoryLinkLabel_W154">Welcome</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/garnet/docs"><span title="Intro" class="linkLabel_WmDU">Intro</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/garnet/docs/welcome/news"><span title="News" class="linkLabel_WmDU">News</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/garnet/docs/welcome/features"><span title="Features" class="linkLabel_WmDU">Features</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/garnet/docs/welcome/releases"><span title="Releases" class="linkLabel_WmDU">Releases</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/garnet/docs/welcome/compatibility"><span title="Compatibility" class="linkLabel_WmDU">Compatibility</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/garnet/docs/welcome/roadmap"><span title="Roadmap" class="linkLabel_WmDU">Roadmap</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/garnet/docs/welcome/faq"><span title="FAQ" class="linkLabel_WmDU">FAQ</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/garnet/docs/welcome/about-us"><span title="About Us" class="linkLabel_WmDU">About Us</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/garnet/docs/getting-started"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/garnet/docs/benchmarking/overview"><span title="Benchmarking" class="categoryLinkLabel_W154">Benchmarking</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/garnet/docs/commands/overview"><span title="Commands" class="categoryLinkLabel_W154">Commands</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/garnet/docs/extensions/overview"><span title="Server Extensions" class="categoryLinkLabel_W154">Server Extensions</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/garnet/docs/cluster/overview"><span title="Cluster Mode" class="categoryLinkLabel_W154">Cluster Mode</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/garnet/docs/cluster/overview"><span title="Overview" class="linkLabel_WmDU">Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/garnet/docs/cluster/replication"><span title="Replication" class="linkLabel_WmDU">Replication</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/garnet/docs/cluster/key-migration"><span title="Key Migration" class="linkLabel_WmDU">Key Migration</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/garnet/docs/dev/onboarding"><span title="Developer Guide" class="categoryLinkLabel_W154">Developer Guide</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/garnet/docs/azure/overview"><span title="Managed Offering (Azure)" class="categoryLinkLabel_W154">Managed Offering (Azure)</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/garnet/docs/research/papers"><span title="Research" class="categoryLinkLabel_W154">Research</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://github.com/microsoft/garnet/releases" target="_blank" rel="noopener noreferrer" class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false"><span title="Other Links" class="categoryLinkLabel_W154">Other Links</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/garnet/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cluster Mode</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Overview</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Garnet Cluster Overview</h1></header>
<p>Garnet cluster provides an easy and scalable way to operate Garnet across multiple nodes.
It supports multiple features including <strong>scaling up/down</strong>, <strong>data migration</strong>, and <strong>data replication</strong>.
This document presents an overview of the sharding mechanics and cluster configuration.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="garnet-cluster-sharding">Garnet Cluster Sharding<a href="#garnet-cluster-sharding" class="hash-link" aria-label="Direct link to Garnet Cluster Sharding" title="Direct link to Garnet Cluster Sharding" translate="no">​</a></h2>
<p>The cluster&#x27;s key space is split into 16384 slots.
Any given slot is owned by a single primary Garnet instance, and any given key maps to only a single slot.
If chosen to setup Garnet with replication, a Garnet instance can operate as a replica and serve read-only requests
for the keys hashing to slots owned by their corresponding primaries.
All single key operations are supported in Garnet cluster.
However, multikey operations are processed only if all keys involved are mapped to a single slot.
Users can overcome this restriction by using hashtags to map differents keys to the same slot.
If a key contains {...}, only the string enclosed is used for the hash function computation.
For example, keys {abc}xyz and xyz{abc} will hash in the same hashlot.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="client-redirection">Client Redirection<a href="#client-redirection" class="hash-link" aria-label="Direct link to Client Redirection" title="Direct link to Client Redirection" translate="no">​</a></h3>
<p>Clients can connect to any node in the cluster and issues single/multi-key operations or any type of
cluster management operations.
The receiving node processes single/multi-key operations by calculating the hashlot value(s) for the key(s) associated with the corresponding operation
and responds in one of the following ways:</p>
<ul>
<li class="">If the slot is owned by the receiving node, it performs the actual operation as expected from standalone Garnet.</li>
<li class="">If the slot is owned by the another node, it responds with -MOVED &lt;slot&gt; &lt;address&gt; &lt;port&gt;</li>
<li class="">If the receiving node is a replica, it will serve only read requests to the slots owned by its primary and redirect any write requests to the primary using -MOVED message.</li>
<li class="">If the slot is owned by the receiving node and that slot is migrating then:<!-- -->
<ul>
<li class="">If the key exists, then read requests are served as normal while write requests return -MIGRATING.</li>
<li class="">If the key does not exist, then read and write requests return -ASK &lt;slot&gt; &lt;address&gt; &lt;port&gt;.</li>
</ul>
</li>
<li class="">If the slot is owned by the another node and the receiving node is the target of the migration operation then:<!-- -->
<ul>
<li class="">Read and write requests are served only if ASKING issued before hand. Note that write safety is not ensured if ASKING is used, so clients should take extra care when using it.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="garnet-cluster-configuration">Garnet Cluster Configuration<a href="#garnet-cluster-configuration" class="hash-link" aria-label="Direct link to Garnet Cluster Configuration" title="Direct link to Garnet Cluster Configuration" translate="no">​</a></h2>
<p>Every Garnet cluster instance retains a persistent local copy of the cluster configuration.
Configuration updates are either directly applied through cluster commands to a specific node
or propagated through the gossip protocol.</p>
<p>The cluster configuration contain slot assignment information and information about every known node
in the cluster.</p>
<p>For more information about the cluster configuration please see the description of <em>CLUSTER NODES</em> command.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="control-plane">Control Plane<a href="#control-plane" class="hash-link" aria-label="Direct link to Control Plane" title="Direct link to Control Plane" translate="no">​</a></h2>
<p>It is important to keep in mind that Garnet&#x27;s cluster mode design is currently <em>passive</em>: this means that it does not implement leader election, and simply responds to cluster
commands issued by a separate <em>control plane</em>. Users have to deploy a control plane (such as an operator in Kubernetes
[<a href="https://github.com/OT-CONTAINER-KIT/redis-operator" target="_blank" rel="noopener noreferrer" class="">example</a>]) to detect failures and request failover. Garnet does not itself yet provide a control plane implementation.
All commands necessary for building a robust control plane are included in Garnet, and our partners have built and deployed
production-quality control plane implementations for internal use with Garnet.</p>
<p>This separation of concerns allows users the flexibility of deploying Garnet over a variety of fabrics such as <a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer" class="">Kubernetes</a>,
<a href="https://learn.microsoft.com/en-us/azure/virtual-machine-scale-sets/overview" target="_blank" rel="noopener noreferrer" class="">Virtual Machine Scale Sets</a>, and <a href="https://azure.microsoft.com/en-us/products/service-fabric" target="_blank" rel="noopener noreferrer" class="">Service Fabric</a>.
This allows users to leverage the production-grade leader election features available in these systems, as well as components such as reliable cloud databases for metadata storage,
for managing the Garnet cluster.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="creating-a-garnet-cluster">Creating a Garnet Cluster<a href="#creating-a-garnet-cluster" class="hash-link" aria-label="Direct link to Creating a Garnet Cluster" title="Direct link to Creating a Garnet Cluster" translate="no">​</a></h2>
<p>Before showing how to create a Garnet cluster, we present below a brief overview of the most important parameters associated
with running a basic Garnet cluster deployment.</p>
<ul>
<li class=""><strong>--port</strong>: Port to run server on. Same port is used for serving queries and internode communication.</li>
<li class=""><strong>--bind</strong>: IP address to bind server</li>
<li class=""><strong>--checkpointdir</strong>: Used to specify the path to checkpoint location and cluster config when --cluster option is enabled.</li>
<li class=""><strong>--cluster</strong>: Enable cluster mode</li>
<li class=""><strong>--cluster-timeout</strong>: Internode communication timeout.</li>
<li class=""><strong>--gossip-delay</strong>: Gossip protocol delay to broadcast send updated configuration or ping known nodes.</li>
<li class=""><strong>--gossip-sp</strong>: Percent of cluster nodes to gossip with at each gossip iteration</li>
</ul>
<p>To create a Garnet cluster you need first to run Garnet instances using the <code>--cluster</code> option as shown below.
Using the <code>--checkpointdir</code> option is optional. It is include in this example to avoid any conflicts between the configuration
files.
If you don&#x27;t specify the <code>--checkpointdir</code> option Garnet will you the startup folder to save any configuration associated</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">	GarnetServer --cluster --checkpointdir clusterData/7000 --port 7000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	GarnetServer --cluster --checkpointdir clusterData/7001 --port 7001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	GarnetServer --cluster --checkpointdir clusterData/7002 --port 7002</span><br></span></code></pre></div></div>
<p>Once the instance are up and running, you can use any kind of redis compatible client to initialize
the cluster to assign slots.</p>
<p>For the above example, we use redis-cli to demonstrate how a cluster is initialized</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">	redis-cli --cluster create 127.0.0.1:7000 127.0.0.1:7001 127.0.0.1:7002 --cluster-yes</span><br></span></code></pre></div></div>
<p>Once the above initialization completes, the cluster is ready to process client queries.
An example of how one may use the initialized cluster is shown below:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1:7000&gt; cluster nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ee337ebd15255c163b0d6faa4d055cdb26215938 127.0.0.1:7000@17000,hostname01 myself,master - 0 0 1 connected 0-5460</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4f86082c3d3250c0dba0f925e71963d46974fbca 127.0.0.1:7002@17002,hostname02 master - 0 0 3 connected 10923-16383</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cf333332b44a32fa70c30862b6d9535e9bac19f9 127.0.0.1:7001@17001,hostname03 master - 0 0 2 connected 5461-10922</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1:7000&gt; cluster keyslot x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(integer) 16287</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1:7000&gt; get x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(error) MOVED 16287 10.159.2.73:7002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1:7000&gt; set x 1234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(error) MOVED 16287 10.159.2.73:7002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1:7000&gt; cluster keyslot wxz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(integer) 949</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1:7000&gt; set wxz 1234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1:7000&gt; get wxz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;1234&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1:7000&gt;</span><br></span></code></pre></div></div>
<p>Alternatively, it is possible to configure the cluster manually or programmatically using a combination of the CLUSTER MEET, CLUSTER SET-CONFIG-EPOCH, CLUSTER ADDSLOTS or CLUSTER ADDSLOTSRANGE, and CLUSTER REPLICATE commands.
The following example demonstrates how to initialize two nodes, assign all slots to one of them, introduce the nodes to each other, and configure the second node as a replica of the first.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7000 cluster nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d6c7f0c2a2839efad9a6578647d6456f90845836 127.0.0.1:7000@17000,localhost myself,master - 0 0 0 connected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7001 cluster nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c65d29d420960fe5213ccb87ce1f74d7ee6ca4f1 127.0.0.1:7001@17001,localhost myself,master - 0 0 0 connected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7000 cluster set-config-epoch 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7001 cluster set-config-epoch 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7000 cluster addslotsrange 0 16383</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7000 cluster nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d6c7f0c2a2839efad9a6578647d6456f90845836 127.0.0.1:7000@17000,localhost myself,master - 0 0 1 connected 0-16383</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7001 cluster nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c65d29d420960fe5213ccb87ce1f74d7ee6ca4f1 127.0.0.1:7001@17001,localhost myself,master - 0 0 2 connected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7000 cluster meet 127.0.0.1 7001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7000 cluster nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d6c7f0c2a2839efad9a6578647d6456f90845836 127.0.0.1:7000@17000,localhost myself,master - 0 0 1 connected 0-16383</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c65d29d420960fe5213ccb87ce1f74d7ee6ca4f1 127.0.0.1:7001@17001,localhost master - 638875895159094739 0 2 connected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7001 cluster nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c65d29d420960fe5213ccb87ce1f74d7ee6ca4f1 127.0.0.1:7001@17001,localhost myself,master - 0 0 2 connected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d6c7f0c2a2839efad9a6578647d6456f90845836 127.0.0.1:7000@17000,localhost master - 638875895161944429 0 1 connected 0-16383</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7001 cluster replicate $(redis-cli -p 7000 cluster myid)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7000 cluster nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d6c7f0c2a2839efad9a6578647d6456f90845836 127.0.0.1:7000@17000,localhost myself,master - 0 0 1 connected 0-16383</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c65d29d420960fe5213ccb87ce1f74d7ee6ca4f1 127.0.0.1:7001@17001,localhost slave d6c7f0c2a2839efad9a6578647d6456f90845836 638875895309129088 638875895309125478 3 connected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt; redis-cli -p 7001 cluster nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c65d29d420960fe5213ccb87ce1f74d7ee6ca4f1 127.0.0.1:7001@17001,localhost myself,slave d6c7f0c2a2839efad9a6578647d6456f90845836 0 0 3 connected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d6c7f0c2a2839efad9a6578647d6456f90845836 127.0.0.1:7000@17000,localhost master - 638875895311833070 638875895311830232 1 connected 0-16383</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Dev&gt;</span><br></span></code></pre></div></div>
<p>Note that the use of redis-cli is not required; any client compatible with the RESP protocol may be used to execute the aforementioned commands.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/microsoft/garnet/tree/main/website/docs/cluster/overview.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/garnet/docs/extensions/module"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Modules</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/garnet/docs/cluster/replication"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Replication</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#garnet-cluster-sharding" class="table-of-contents__link toc-highlight">Garnet Cluster Sharding</a><ul><li><a href="#client-redirection" class="table-of-contents__link toc-highlight">Client Redirection</a></li></ul></li><li><a href="#garnet-cluster-configuration" class="table-of-contents__link toc-highlight">Garnet Cluster Configuration</a></li><li><a href="#control-plane" class="table-of-contents__link toc-highlight">Control Plane</a></li><li><a href="#creating-a-garnet-cluster" class="table-of-contents__link toc-highlight">Creating a Garnet Cluster</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/garnet/docs/getting-started">Getting Started</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://aka.ms/garnet-discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/msrgarnet" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/garnet/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/microsoft/garnet" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p class="text-center">
          <a href="https://go.microsoft.com/fwlink/?LinkId=521839" style="color: white;">Privacy &amp; Cookies</a> |
          <a href="https://go.microsoft.com/fwlink/?LinkID=2259814" style="color: white;">Consumer Health Privacy</a> |
          <a href="https://go.microsoft.com/fwlink/?LinkID=206977" style="color: white;">Terms of Use</a> |
          <a href="https://www.microsoft.com/trademarks" style="color: white;">Trademarks</a> | © 2025
          </p></div></div></div></footer></div>
</body>
</html>