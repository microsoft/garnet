"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[6449],{67687(e,r,t){t.r(r),t.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"azure/security","title":"Secure your Azure Cosmos DB Garnet Cache","description":"Azure Cosmos DB Garnet Cache provides enterprise-grade security features to protect your data. This guide covers the security capabilities and best practices for securing your cache.","source":"@site/docs/azure/security.md","sourceDirName":"azure","slug":"/azure/security","permalink":"/garnet/docs/azure/security","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/garnet/tree/main/website/docs/azure/security.md","tags":[],"version":"current","frontMatter":{"id":"security","sidebar_label":"Security","title":"Secure your Azure Cosmos DB Garnet Cache"},"sidebar":"garnetDocSidebar","previous":{"title":"Resiliency","permalink":"/garnet/docs/azure/resiliency"},"next":{"title":"Monitoring","permalink":"/garnet/docs/azure/monitoring"}}');var s=t(74848),i=t(28453);const o={id:"security",sidebar_label:"Security",title:"Secure your Azure Cosmos DB Garnet Cache"},a="Secure your Azure Cosmos DB Garnet Cache",c={},d=[{value:"Network Security",id:"network-security",level:2},{value:"Required outbound network rules",id:"required-outbound-network-rules",level:3},{value:"Authentication and Access Control",id:"authentication-and-access-control",level:2},{value:"Built-in Roles",id:"built-in-roles",level:3},{value:"Data Encryption",id:"data-encryption",level:2},{value:"Learn More",id:"learn-more",level:2}];function l(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"secure-your-azure-cosmos-db-garnet-cache",children:"Secure your Azure Cosmos DB Garnet Cache"})}),"\n",(0,s.jsx)(r.p,{children:"Azure Cosmos DB Garnet Cache provides enterprise-grade security features to protect your data. This guide covers the security capabilities and best practices for securing your cache."}),"\n",(0,s.jsx)(r.h2,{id:"network-security",children:"Network Security"}),"\n",(0,s.jsx)(r.p,{children:"Azure Cosmos DB Garnet Cache does not provide public IP addresses or DNS, meaning it can't be accessed from the public internet. Cache nodes are provisioned on the virtual network provided during cluster creation. They are accessible via the internal IP addresses from the same VNet."}),"\n",(0,s.jsx)(r.p,{children:"There are the 2 options to connect to the cache:"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["Deploy the clients connecting to the cache on the same virtual network with either the same subnet, or a different one. The Redis clients can use the internal IP address of the cache instances to connect. Learn how to ",(0,s.jsx)(r.a,{href:"/garnet/docs/azure/quickstart#step-4-connect-and-test",children:"find your internal IP addresses"}),"."]}),"\n",(0,s.jsxs)(r.li,{children:["If the client applications are deployed in a separate virtual network, then you can use ",(0,s.jsx)(r.a,{href:"https://learn.microsoft.com/azure/virtual-network/virtual-network-peering-overview",children:"virtual network peering"})," to connect the two. Follow the steps in this ",(0,s.jsx)(r.a,{href:"https://learn.microsoft.com/azure/virtual-network/tutorial-connect-virtual-networks?tabs=portal",children:"tutorial"}),". Ensure that the IP address space of the two virtual networks does not overlap. Once peering is established successfully, the client application in one virtual network can access the cache endpoints on the other network using their local IP addresses."]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"required-outbound-network-rules",children:"Required outbound network rules"}),"\n",(0,s.jsxs)(r.p,{children:["If you use Azure Firewall to restrict outbound access from the existing subnet, we highly recommend that you use\u202f",(0,s.jsx)(r.a,{href:"https://learn.microsoft.com/azure/virtual-network/service-tags-overview",children:"virtual network service tags"}),". The tags in the following table are required to make the Azure Cosmos DB Garnet Cache function properly."]}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Destination service tag"}),(0,s.jsx)(r.th,{children:"Protocol"}),(0,s.jsx)(r.th,{children:"Port"}),(0,s.jsx)(r.th,{children:"Use"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Storage"}),(0,s.jsx)(r.td,{children:"HTTPS"}),(0,s.jsx)(r.td,{children:"443"}),(0,s.jsx)(r.td,{children:"Required for secure communication between the nodes and Azure Storage for Control Plane communication and configuration."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"AzureKeyVault"}),(0,s.jsx)(r.td,{children:"HTTPS"}),(0,s.jsx)(r.td,{children:"443"}),(0,s.jsx)(r.td,{children:"Required for secure communication between the nodes and Azure Key Vault. Certificates and keys are used to secure communication inside the cache."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"EventHub"}),(0,s.jsx)(r.td,{children:"HTTPS"}),(0,s.jsx)(r.td,{children:"443"}),(0,s.jsx)(r.td,{children:"Required to forward logs to Azure."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"AzureMonitor"}),(0,s.jsx)(r.td,{children:"HTTPS"}),(0,s.jsx)(r.td,{children:"443"}),(0,s.jsx)(r.td,{children:"Required to forward metrics to Azure."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"AzureActiveDirectory"}),(0,s.jsx)(r.td,{children:"HTTPS"}),(0,s.jsx)(r.td,{children:"443"}),(0,s.jsx)(r.td,{children:"Required for Microsoft Entra authentication."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"AzureResourceManager"}),(0,s.jsx)(r.td,{children:"HTTPS"}),(0,s.jsx)(r.td,{children:"443"}),(0,s.jsx)(r.td,{children:"Required to gather information about and manage Garnet nodes (for example, reboot)."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"AzureFrontDoor.Firstparty"}),(0,s.jsx)(r.td,{children:"HTTPS"}),(0,s.jsx)(r.td,{children:"443"}),(0,s.jsx)(r.td,{children:"Required for logging operations."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"GuestAndHybridManagement"}),(0,s.jsx)(r.td,{children:"HTTPS"}),(0,s.jsx)(r.td,{children:"443"}),(0,s.jsx)(r.td,{children:"Required to gather information about and manage Garnet nodes (for example, reboot)."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"ApiManagement"}),(0,s.jsx)(r.td,{children:"HTTPS"}),(0,s.jsx)(r.td,{children:"443"}),(0,s.jsx)(r.td,{children:"Required to gather information about and manage Garnet nodes (for example, reboot)."})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"In addition to the tags table, you need to add the following address prefixes because a service tag doesn't exist for the relevant service:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"104.40.0.0/13"}),"\n",(0,s.jsx)(r.li,{children:"13.104.0.0/14"}),"\n",(0,s.jsx)(r.li,{children:"40.64.0.0/10"}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"authentication-and-access-control",children:"Authentication and Access Control"}),"\n",(0,s.jsx)(r.p,{children:"Azure Cosmos DB Garnet Cache uses Azure RBAC to secure your data by granting permissions for supported Redis commands. Microsoft Entra ID RBAC roles define fine-grained permissions and are required to use data plane operations. No roles are assigned by default, including to the resource creator. You can assign roles to users, groups, service principals or managed identities for data access. Note that role assignments can take several minutes to propagate after being created or modified."}),"\n",(0,s.jsx)(r.h3,{id:"built-in-roles",children:"Built-in Roles"}),"\n",(0,s.jsxs)(r.p,{children:["There are several built-in roles to help you manage data access. Learn how to ",(0,s.jsx)(r.a,{href:"/garnet/docs/azure/quickstart#step-2-configure-data-access-with-rbac",children:"assign roles"})," using the Azure portal or Azure CLI."]}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Role"}),(0,s.jsx)(r.th,{children:"Use Case"}),(0,s.jsx)(r.th,{children:"Access Level"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Garnet Data Reader"})}),(0,s.jsx)(r.td,{children:"Read-only applications, monitoring"}),(0,s.jsx)(r.td,{children:"GET, EXISTS etc."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Garnet Data Contributor"})}),(0,s.jsx)(r.td,{children:"Most applications"}),(0,s.jsx)(r.td,{children:"Read/write string, hash, set, sorted set"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Garnet Data Owner"})}),(0,s.jsx)(r.td,{children:"Admin access, full control"}),(0,s.jsx)(r.td,{children:"All operations including destructive ones"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Garnet Script Data Contributor"})}),(0,s.jsx)(r.td,{children:"Script execution and management"}),(0,s.jsx)(r.td,{children:"All scripting"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Garnet PubSub Data Reader"})}),(0,s.jsx)(r.td,{children:"Reading pub/sub messages"}),(0,s.jsx)(r.td,{children:"Read access to pub/sub channels"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Garnet PubSub Data Contributor"})}),(0,s.jsx)(r.td,{children:"All pub/sub messaging"}),(0,s.jsx)(r.td,{children:"Publish/subscribe operations"})]})]})]}),"\n",(0,s.jsxs)(r.p,{children:["To see detailed permissions associated with each role, navigate to the ",(0,s.jsx)(r.strong,{children:"Access control (IAM)"})," page of your Garnet Cache resource in the ",(0,s.jsx)(r.a,{href:"https://aka.ms/garnet-portal",children:"Azure portal"}),". The Azure Cosmos DB Garnet Cache is in an expanded Private Preview and you must access the Azure portal through this link to manage your caches. The ",(0,s.jsx)(r.strong,{children:"Roles"})," tab has all available roles. Search for ",(0,s.jsx)(r.strong,{children:"garnet"})," and view the details for each role."]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{alt:"Built-in Roles",src:t(80255).A+"",width:"1294",height:"550"})}),"\n",(0,s.jsxs)(r.p,{children:["See a detailed list of allowed commands for each role under ",(0,s.jsx)(r.strong,{children:"Permissions > DataActions"}),"."]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{alt:"Garnet Data Contributor permissions",src:t(42943).A+"",width:"958",height:"910"})}),"\n",(0,s.jsx)(r.h2,{id:"data-encryption",children:"Data Encryption"}),"\n",(0,s.jsx)(r.p,{children:"Azure Cosmos DB Garnet Cache implements comprehensive data protection measures to ensure your data remains secure both at rest and in transit, giving you end-to-end encryption. TLS 1.2 or higher and node-to-node encryption are enforced."}),"\n",(0,s.jsx)(r.h2,{id:"learn-more",children:"Learn More"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"/garnet/docs/azure/cluster-configuration",children:"Cluster Configuration"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"/garnet/docs/azure/resiliency",children:"Resiliency"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"/garnet/docs/azure/monitoring",children:"Monitoring"})}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},80255(e,r,t){t.d(r,{A:()=>n});const n=t.p+"assets/images/built-in-roles-293c32c3b503641dee010d3275026c64.png"},42943(e,r,t){t.d(r,{A:()=>n});const n=t.p+"assets/images/garnet-data-contributor-1cf8c79d3fa44ab7856949fcce4cdc06.png"},28453(e,r,t){t.d(r,{R:()=>o,x:()=>a});var n=t(96540);const s={},i=n.createContext(s);function o(e){const r=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(i.Provider,{value:r},e.children)}}}]);