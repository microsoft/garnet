"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[8923],{13420(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"azure/monitoring","title":"Monitoring Azure Cosmos DB Garnet Cache","description":"Azure Cosmos DB Garnet Cache provides comprehensive monitoring capabilities through Azure Monitor, enabling you to track performance, troubleshoot issues, and optimize your cache deployment.","source":"@site/docs/azure/monitoring.md","sourceDirName":"azure","slug":"/azure/monitoring","permalink":"/garnet/docs/azure/monitoring","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/garnet/tree/main/website/docs/azure/monitoring.md","tags":[],"version":"current","frontMatter":{"id":"monitoring","sidebar_label":"Monitoring","title":"Monitoring Azure Cosmos DB Garnet Cache"},"sidebar":"garnetDocSidebar","previous":{"title":"Security","permalink":"/garnet/docs/azure/security"},"next":{"title":"FAQ","permalink":"/garnet/docs/azure/faq"}}');var r=s(74848),t=s(28453);const o={id:"monitoring",sidebar_label:"Monitoring",title:"Monitoring Azure Cosmos DB Garnet Cache"},c="Monitoring Azure Cosmos DB Garnet Cache",d={},l=[{value:"Azure Monitor",id:"azure-monitor",level:2},{value:"Metrics",id:"metrics",level:3},{value:"Garnet Client Metrics",id:"garnet-client-metrics",level:4},{value:"Query Performance Metrics",id:"query-performance-metrics",level:4},{value:"Garnet Store Metrics",id:"garnet-store-metrics",level:4},{value:"System Metrics",id:"system-metrics",level:4},{value:"Activity log",id:"activity-log",level:3},{value:"Troubleshooting Common Issues",id:"troubleshooting-common-issues",level:2},{value:"High CPU Usage",id:"high-cpu-usage",level:3},{value:"Symptoms",id:"symptoms",level:4},{value:"Resolution Steps",id:"resolution-steps",level:4},{value:"High Memory Usage",id:"high-memory-usage",level:3},{value:"Symptoms",id:"symptoms-1",level:4},{value:"Resolution Steps",id:"resolution-steps-1",level:4},{value:"Connection Issues",id:"connection-issues",level:3},{value:"Symptoms",id:"symptoms-2",level:4},{value:"Resolution Steps",id:"resolution-steps-2",level:4},{value:"Performance Degradation",id:"performance-degradation",level:3},{value:"Symptoms",id:"symptoms-3",level:4},{value:"Resolution Steps",id:"resolution-steps-3",level:4},{value:"Learn More",id:"learn-more",level:2}];function a(e){const n={a:"a",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"monitoring-azure-cosmos-db-garnet-cache",children:"Monitoring Azure Cosmos DB Garnet Cache"})}),"\n",(0,r.jsx)(n.p,{children:"Azure Cosmos DB Garnet Cache provides comprehensive monitoring capabilities through Azure Monitor, enabling you to track performance, troubleshoot issues, and optimize your cache deployment."}),"\n",(0,r.jsx)(n.h2,{id:"azure-monitor",children:"Azure Monitor"}),"\n",(0,r.jsx)(n.h3,{id:"metrics",children:"Metrics"}),"\n",(0,r.jsxs)(n.p,{children:["Azure Cosmos DB Garnet Cache automatically collects metrics and sends them to Azure Monitor. Most metrics have ",(0,r.jsx)(n.strong,{children:"Min"}),", ",(0,r.jsx)(n.strong,{children:"Max"}),", and ",(0,r.jsx)(n.strong,{children:"Average"})," aggregations as well as the ability to split by ",(0,r.jsx)(n.strong,{children:"Node"})," for detailed insights into cluster performance."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Azure Monitor Metrics",src:s(66460).A+"",width:"1654",height:"849"})}),"\n",(0,r.jsx)(n.h4,{id:"garnet-client-metrics",children:"Garnet Client Metrics"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Metric"}),(0,r.jsx)(n.th,{children:"Additional Information"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Connected Clients"}),(0,r.jsx)(n.td,{})]})})]}),"\n",(0,r.jsx)(n.h4,{id:"query-performance-metrics",children:"Query Performance Metrics"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Metric"}),(0,r.jsx)(n.th,{children:"Additional Information"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Command Process Rate"}),(0,r.jsx)(n.td,{children:"The total number of commands processed per second."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Query Latency P99"}),(0,r.jsx)(n.td,{children:"The P99 latency of processing per network call received server-side, considering only non-admin requests. Reported in microseconds."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Query Latency Mean"}),(0,r.jsx)(n.td,{children:"The mean latency of processing per network call received server-side, considering only non-admin requests. Reported in microseconds."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Read Command Process Rate"}),(0,r.jsx)(n.td,{children:"The number of read commands processed."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Write Command Process Rate"}),(0,r.jsx)(n.td,{children:"The number of write commands processed."})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"garnet-store-metrics",children:"Garnet Store Metrics"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Metric"}),(0,r.jsx)(n.th,{children:"Additional Information"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Index Size"}),(0,r.jsx)(n.td,{children:"The size of the index in the main store in bytes."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Log Size"}),(0,r.jsx)(n.td,{children:"The size of the log in the main store in bytes."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Main Store Size"}),(0,r.jsx)(n.td,{children:"Total size of the main store including index, log, and overflow in bytes."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Read Cache Size"}),(0,r.jsx)(n.td,{children:"Size of read cache in the main store in bytes."})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"system-metrics",children:"System Metrics"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Metric"}),(0,r.jsx)(n.th,{children:"Additional Information"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Average CPU Usage Active"}),(0,r.jsx)(n.td,{children:"Average active CPU usage across all CPUs."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CPU Usage Active"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Memory Utilization"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Network Received Bytes"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Network Received Packets"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Network Transmitted Bytes"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Network Transmitted Packets"}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"activity-log",children:"Activity log"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/azure/azure-monitor/platform/activity-log",children:"Azure Monitor activity log"})," contains entries for control plane events from Azure Cosmos DB Garnet Cache resources. It includes information like when a cache cluster is created, when scaling operations occur, or when RBAC permissions are granted. Use the activity log to review or audit administrative actions on your Azure Cosmos DB Garnet Cache resources, or create alerts to be proactively notified when control plane events occur."]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting-common-issues",children:"Troubleshooting Common Issues"}),"\n",(0,r.jsx)(n.h3,{id:"high-cpu-usage",children:"High CPU Usage"}),"\n",(0,r.jsxs)(n.p,{children:["High CPU usage can indicate various performance bottlenecks in your cluster. Use the ",(0,r.jsx)(n.strong,{children:"Average CPU Usage Active"})," and ",(0,r.jsx)(n.strong,{children:"CPU Usage Active"})," metrics to identify and resolve CPU-related issues."]}),"\n",(0,r.jsx)(n.h4,{id:"symptoms",children:"Symptoms"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Average CPU Usage Active"})," consistently above 80%."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CPU Usage Active"})," showing spikes during peak usage."]}),"\n",(0,r.jsxs)(n.li,{children:["Increased ",(0,r.jsx)(n.strong,{children:"Query Latency P99"})," and ",(0,r.jsx)(n.strong,{children:"Query Latency Mean"})," values."]}),"\n",(0,r.jsxs)(n.li,{children:["Degraded ",(0,r.jsx)(n.strong,{children:"Command Process Rate"})," performance."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"resolution-steps",children:"Resolution Steps"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Analyze Command Patterns"}),": Review ",(0,r.jsx)(n.strong,{children:"Command Process Rate"})," trends to identify peak usage periods causing high CPU load."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitor Node Distribution"}),": Use the Node split feature to identify if specific nodes are experiencing higher CPU usage than others."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scale Compute Resources"}),": Consider increasing the replication factor if ",(0,r.jsx)(n.strong,{children:"Read Command Process Rate"})," is high, or increase the shard count if ",(0,r.jsx)(n.strong,{children:"Write Command Process Rate"})," is high."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"high-memory-usage",children:"High Memory Usage"}),"\n",(0,r.jsxs)(n.p,{children:["Memory utilization issues can lead to performance degradation and potential data eviction. Monitor ",(0,r.jsx)(n.strong,{children:"Memory Utilization"})," alongside store-specific metrics to maintain optimal performance."]}),"\n",(0,r.jsx)(n.h4,{id:"symptoms-1",children:"Symptoms"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Memory Utilization"})," approaching or exceeding 85%."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Main Store Size"})," growing rapidly or unexpectedly."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Index Size"})," or ",(0,r.jsx)(n.strong,{children:"Log Size"})," consuming excessive memory."]}),"\n",(0,r.jsx)(n.li,{children:"Increased cache misses or eviction events."}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"resolution-steps-1",children:"Resolution Steps"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Analyze Memory Distribution"}),": Review ",(0,r.jsx)(n.strong,{children:"Main Store Size"}),", ",(0,r.jsx)(n.strong,{children:"Index Size"}),", ",(0,r.jsx)(n.strong,{children:"Log Size"}),", and ",(0,r.jsx)(n.strong,{children:"Read Cache Size"})," to identify which component is consuming the most memory."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Implement TTL Strategies"}),": Set appropriate time-to-live values for cached data to ensure automatic cleanup."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Optimize Data Structures"}),": Use more memory-efficient data types where appropriate."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scale Memory Resources"}),": Consider increasing the shard count for more memory, or scale-up to a higher SKU."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"connection-issues",children:"Connection Issues"}),"\n",(0,r.jsxs)(n.p,{children:["Connection problems can manifest through various network and client metrics. Use ",(0,r.jsx)(n.strong,{children:"Connected Clients"}),", ",(0,r.jsx)(n.strong,{children:"Network Received/Transmitted Bytes"}),", and ",(0,r.jsx)(n.strong,{children:"Network Received/Transmitted Packets"})," to diagnose connectivity issues."]}),"\n",(0,r.jsx)(n.h4,{id:"symptoms-2",children:"Symptoms"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Connected Clients"})," count dropping unexpectedly or remaining at zero."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Network Received Bytes"})," or ",(0,r.jsx)(n.strong,{children:"Network Transmitted Bytes"})," showing irregular patterns."]}),"\n",(0,r.jsx)(n.li,{children:"Client applications reporting connection timeouts or failures."}),"\n",(0,r.jsxs)(n.li,{children:["Inconsistent ",(0,r.jsx)(n.strong,{children:"Command Process Rate"})," despite steady application load."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"resolution-steps-2",children:"Resolution Steps"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Verify Network Connectivity"}),": Test basic network connectivity from client applications to the cache endpoint."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Review Authentication"}),": Verify that authentication credentials are valid and have appropriate permissions. If you recently assigned roles, wait a few minutes for the assignments to propagate."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitor Connection Patterns"}),": Analyze ",(0,r.jsx)(n.strong,{children:"Connected Clients"})," trends to identify if connection issues are intermittent or persistent."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Review Client Configuration"}),": Ensure client applications are using appropriate connection timeout and retry settings."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"performance-degradation",children:"Performance Degradation"}),"\n",(0,r.jsx)(n.p,{children:"Performance issues can affect various aspects of your cache operations. Use latency and throughput metrics to identify and resolve performance bottlenecks."}),"\n",(0,r.jsx)(n.h4,{id:"symptoms-3",children:"Symptoms"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Query Latency P99"})," exceeding SLA thresholds (consistently above 3ms)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Query Latency Mean"})," showing consistent increases."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Command Process Rate"})," declining despite steady or increased demand."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Read Command Process Rate"})," or ",(0,r.jsx)(n.strong,{children:"Write Command Process Rate"})," not meeting expected throughput."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"resolution-steps-3",children:"Resolution Steps"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Analyze Latency Patterns"}),": Compare ",(0,r.jsx)(n.strong,{children:"Query Latency P99"})," and ",(0,r.jsx)(n.strong,{children:"Query Latency Mean"})," to identify if performance issues are persistent."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Check Resource Utilization"}),": Review ",(0,r.jsx)(n.strong,{children:"CPU Usage Active"})," and ",(0,r.jsx)(n.strong,{children:"Memory Utilization"})," to identify resource constraints."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Evaluate Network Performance"}),": Check ",(0,r.jsx)(n.strong,{children:"Network Received/Transmitted Bytes"})," and ",(0,r.jsx)(n.strong,{children:"Packets"})," for signs of network congestion."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Review Command Distribution"}),": Analyze ",(0,r.jsx)(n.strong,{children:"Read Command Process Rate"})," vs ",(0,r.jsx)(n.strong,{children:"Write Command Process Rate"})," to understand workload characteristics."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Identify Node Hotspots"}),": Use Node-level metrics to detect if specific nodes are experiencing disproportionate load."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scale Appropriately"}),": Consider upgrading to higher performance tiers or adding more nodes based on the specific bottleneck identified."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"learn-more",children:"Learn More"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/garnet/docs/azure/quickstart",children:"Getting Started"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/garnet/docs/azure/cluster-configuration",children:"Cluster Configuration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/garnet/docs/azure/security",children:"Security"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},66460(e,n,s){s.d(n,{A:()=>i});const i=s.p+"assets/images/metrics-e7d7f491828a7ee375183200320f1906.png"},28453(e,n,s){s.d(n,{R:()=>o,x:()=>c});var i=s(96540);const r={},t=i.createContext(r);function o(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);